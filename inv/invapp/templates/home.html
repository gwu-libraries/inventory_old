{% extends "base.html" %}
{% load url from future %}
{% load invapp_extras %}

{% block title %}
    GWU Libraries Digital Inventory
{% endblock title %}

{% block javascript_extra %}
<link rel="stylesheet" href="http://code.jquery.com/ui/1.10.2/themes/smoothness/jquery-ui.css" />
<script type='text/javascript' src='https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js'></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.16/jquery-ui.min.js" type="text/javascript"></script>
<script type="text/javascript">
        $(function() {
            $("#search_collection").autocomplete({
                select: function(event, ui) {
                    $(this).val(ui.item.value);
                    $("#search_form").submit();
                },
                source: function(request, response) {
                    $.ajax({
                        url: "/ajax/search_collection_autocomplete/",
                        dataType: "json",
                        data: { search: request.term },
                        success: function(data) {
                            response($.map(data, function(item) {
                                    return {
                                        value: item.pk,
                                        label: item.pk + " : " + item.fields.name
                                    }
                            }));
                        },     
                   });
                },
                minLength: 2,
            });
         });
</script>
<style>
.ui-autocomplete {
    max-height: 100px;
    max-width: 400px;
    overflow-y: auto;
    overflow-x: auto;
}
</style>
{% endblock javascript_extra %}

{% block content %}
<section id="machines" class="container-fluid">
    <h3>Digital Storage Places (Machines)<h3>
    <table class="table table-striped">
        <tr>
            <th>Name</th>
            <th>URL</th>
            <th>Notes</th>
        </tr>
        {% for machine in machines %}
            <tr>
                <td><a href="{% url 'machine' machine.id %}">{{ machine.name }}</a></td>
                <td>{{ machine.url }}</td>
                <td>{{ machines.notes }}</td>
            </tr>
        {% endfor %}
    </table>
</section>
<section id="collections" class="container-fluid">
    <h3>Our Collections</h3>
    
    {% if collections.paginator.count > 10 %}
        {% bootstrap_paginator_bar collections 'collections_page' %}
    {% endif %}
    <div style="width:100%;float:left;">
        <form id="search_form" action="{% url 'home' %}" method="GET">
            <label for="search_collection"><h5>Search: </h5></label>
            <input id="search_collection" name="search_collection" type="text" />
        </form>
    </div>
    <table class="table table-striped">
        <tr>
            <th>ID</th>
            <th>Collection</th>
            <th>Manager</th>
            <th>Description</th>
        </tr>
        {% for collection in collections %}
            <tr class="collection">
                <td><a href="{% url 'collection' collection.id %}">{{ collection.id }}</a></td>
                <td>{{ collection.name }}</td>
                <td>{{ collection.manager }}</td>
                <td>{{ collection.description }}</td>
            </tr>
        {% endfor %}
    </table>
</section>
<section id="projects" class="container-fluid">
    <h3>Current Projects</h3>
    <table class="table table-striped">
        <tr>
            <th>ID</th>
            <th>Project</th>
        </tr>
        {% for project in projects %}
            <tr class="project">
                <td><a href="{% url 'project' project.id %}">{{ project.id }}</a></td>
                <td>{{ project.name }}</td>
            </tr>
        {% endfor %}
    </table>
</section>
<section id="items" class="container-fluid">
    <h3>Recently Added Items</h3>
    <table class="table table-striped">
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Local ID</th>
            <th>Project</th>
            <th>Collection</th>
            <th>Created</th>
            <th>Item Type</th>
        </tr>
        {% for item in items %}
            <tr class="item">
                <td><a href="{% url 'item' item.id %}">{{ item.id }}</a></td>
                <td>{{ item.title }}</td>
                <td>{{ item.local_id }}</td>
                <td>{{ item.project.name }}</td>
                <td>{{ item.collection.name }}</td>
                <td>{{ item.created }}</td>
                <td>{{ item.get_original_item_type_display }}</td>
            </tr>
        {% endfor %}
    </table>
</section>

{% endblock content %}
